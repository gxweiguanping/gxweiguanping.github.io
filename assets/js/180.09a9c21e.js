(window.webpackJsonp=window.webpackJsonp||[]).push([[180],{510:function(s,a,n){"use strict";n.r(a);var t=n(8),e=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"配置mysql以及创建es索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置mysql以及创建es索引"}},[s._v("#")]),s._v(" 配置mysql以及创建es索引")]),s._v(" "),a("p",[s._v("因为canal是基于bin log来实现的，所以要开启binlog，并且设置binlog模式为行模式。")]),s._v(" "),a("h3",{attrs:{id:"开启bin-log"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#开启bin-log"}},[s._v("#")]),s._v(" "),a("strong",[s._v("开启bin log")])]),s._v(" "),a("p",[s._v("修改mysql8的配置文件my.cnf")]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[s._v("sudo vim "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("my"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cnf\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("添加以下内容")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("log-bin=mysql-bin\nbinlog_format=ROW\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("strong",[s._v("登录mysql查看是否开启成功")])]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SHOW")]),s._v(" variables like '"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("log_bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("'\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://gitee.com/studentgitee/note-picture/raw/master/image-20230210202152999.png",alt:"image-20230210202152999"}})]),s._v(" "),a("h3",{attrs:{id:"创建canal用户"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建canal用户"}},[s._v("#")]),s._v(" 创建canal用户")]),s._v(" "),a("p",[s._v("我们创建一个canal用户，专门用于canal同步数据库使用\n登录mysql，执行")]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[s._v("# 注意大小写\n\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("USER")]),s._v(" canal "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("IDENTIFIED")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("BY")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'canaL'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("GRANT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SELECT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("REPLICATION")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SLAVE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("REPLICATION")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CLIENT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ON")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("TO")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'canal'")]),s._v("@"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("FLUSH")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PRIVILEGES")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h3",{attrs:{id:"创建es索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建es索引"}},[s._v("#")]),s._v(" 创建es索引")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('PUT cs_line\n{\n  "mappings": {\n    "properties": {\n      "id": {\n        "type": "keyword"\n      },\n      "line_name":{\n         "type": "keyword"\n      },\n      "line_code":{\n         "type": "keyword"\n      },\n      "description":{\n        "type": "keyword"\n      }\n    }\n  }\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);