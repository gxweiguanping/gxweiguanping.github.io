(window.webpackJsonp=window.webpackJsonp||[]).push([[117],{447:function(s,a,e){"use strict";e.r(a);var t=e(8),r=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"centos7在线安装docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#centos7在线安装docker"}},[s._v("#")]),s._v(" CentOS7在线安装Docker")]),s._v(" "),a("p",[s._v("Docker 支持以下的 64 位 CentOS 版本：")]),s._v(" "),a("ul",[a("li",[s._v("CentOS 7")]),s._v(" "),a("li",[s._v("CentOS 8")]),s._v(" "),a("li",[s._v("更高版本...")])]),s._v(" "),a("h3",{attrs:{id:"步骤1-所有平台通用安装-bash方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#步骤1-所有平台通用安装-bash方式"}},[s._v("#")]),s._v(" "),a("strong",[s._v("步骤1：所有平台通用安装(bash方式）")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-fsSL")]),s._v(" https://get.docker.com "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--mirror")]),s._v(" Aliyun\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"步骤2-启动docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#步骤2-启动docker"}},[s._v("#")]),s._v(" "),a("strong",[s._v("步骤2：启动docker")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl start "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("  \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("默认情况下，"),a("code",[s._v("docker")]),s._v(" 命令会使用 "),a("a",{attrs:{href:"https://en.wikipedia.org/wiki/Unix_domain_socket",target:"_blank",rel:"noopener noreferrer"}},[s._v("Unix socket (opens new window)"),a("OutboundLink")],1),s._v("与 Docker 引擎通讯。而只有 "),a("code",[s._v("root")]),s._v(" 用户和 "),a("code",[s._v("docker")]),s._v(" 组的用户才可")]),s._v(" "),a("p",[s._v("以访问 Docker 引擎的 Unix socket。出于安全考虑，一般 Linux 系统上不会直接使用 "),a("code",[s._v("root")]),s._v(" 用户。因此，更好地做法是将需要使用")]),s._v(" "),a("p",[a("code",[s._v("docker")]),s._v(" 的用户加入 "),a("code",[s._v("docker")]),s._v(" 用户组。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("groupadd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建一个docker组")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("usermod")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-aG")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$USER")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#将当前用户加入组")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"步骤3-配置加速镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#步骤3-配置加速镜像"}},[s._v("#")]),s._v(" "),a("strong",[s._v("步骤3：配置加速镜像")])]),s._v(" "),a("p",[s._v("目前主流 Linux 发行版均已使用 "),a("a",{attrs:{href:"https://systemd.io/",target:"_blank",rel:"noopener noreferrer"}},[s._v("systemd (opens new window)"),a("OutboundLink")],1),s._v("进行服务管理，这里介绍如何在使用 systemd 的 Linux 发行版中配置镜")]),s._v(" "),a("p",[s._v("像加速器。")]),s._v(" "),a("p",[s._v("1、请首先执行以下命令，查看是否在 "),a("code",[s._v("docker.service")]),s._v(" 文件中配置过镜像地址。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("systemctl "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\\-\\-registry\\-mirror'")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("2、如果该命令有输出，那么请执行 "),a("code",[s._v("$ systemctl cat docker")]),s._v(" 查看 "),a("code",[s._v("ExecStart=")]),s._v(" 出现的位置，修改对应的文件内容去掉 "),a("code",[s._v("--registry-mirror")]),s._v(" 参数及其值，并按接下来的步骤进行配置。")]),s._v(" "),a("p",[s._v("3、如果以上命令没有任何输出，那么就可以在 "),a("code",[s._v("/etc/docker/daemon.json")]),s._v(" 中写入如下内容（如果文件不存在请新建该文件）：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"registry-mirrors"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://hub-mirror.c.163.com"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://registry.docker-cn.com"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://y4xpdpoy.mirror.aliyuncs.com"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("blockquote",[a("p",[s._v("注意，一定要保证该文件符合 json 规范，否则 Docker 将不能启动。")])]),s._v(" "),a("h3",{attrs:{id:"步骤4-重新启动服务。"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#步骤4-重新启动服务。"}},[s._v("#")]),s._v(" "),a("strong",[s._v("步骤4：重新启动服务。")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl daemon-reload\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl restart "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"步骤5-查看镜像是否配置成功"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#步骤5-查看镜像是否配置成功"}},[s._v("#")]),s._v(" "),a("strong",[s._v("步骤5：查看镜像是否配置成功")])]),s._v(" "),a("p",[s._v("执行 "),a("code",[s._v("$ docker info")]),s._v("，如果从结果中看到内容，说明配置成功。")]),s._v(" "),a("h2",{attrs:{id:"更改docker保存数据的位置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#更改docker保存数据的位置"}},[s._v("#")]),s._v(" "),a("strong",[s._v("更改docker保存数据的位置")])]),s._v(" "),a("p",[s._v("使用 Docker 的官方安装脚本或包管理器进行安装时，Docker 的二进制文件通常会被安装到系统的默认位置，如 "),a("code",[s._v("/usr/bin")]),s._v("，并不支持在安装时直接指定安装目录。")]),s._v(" "),a("p",[s._v("然而，你可以更改 Docker 的一些运行配置，包括 Docker 镜像、容器等数据的存储位置。Docker 默认将这些数据存储在 "),a("code",[s._v("/var/lib/docker")]),s._v(" 目录，你可以通过修改 Docker 服务的启动参数，将其更改为其他目录。")]),s._v(" "),a("p",[s._v("假设你想将 Docker 的数据存储在 "),a("code",[s._v("/data/docker")]),s._v(" 目录，你可以按照以下步骤操作")]),s._v(" "),a("h3",{attrs:{id:"停止-docker-服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#停止-docker-服务"}},[s._v("#")]),s._v(" "),a("strong",[s._v("停止 Docker 服务")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl stop "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"移动-docker-的数据目录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#移动-docker-的数据目录"}},[s._v("#")]),s._v(" "),a("strong",[s._v("移动 Docker 的数据目录")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" /var/lib/docker /data/\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"编辑-docker-服务的配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编辑-docker-服务的配置"}},[s._v("#")]),s._v(" "),a("strong",[s._v("编辑 Docker 服务的配置")])]),s._v(" "),a("p",[s._v("在 "),a("code",[s._v("/etc/systemd/system/")]),s._v(" 目录下，创建一个名为 "),a("code",[s._v("docker.service.d")]),s._v(" 的目录，然后在该目录下创建一个名为 "),a("code",[s._v("storage.conf")]),s._v(" 的文件：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /etc/systemd/system/docker.service.d\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/systemd/system/docker.service.d/storage.conf\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"在-storage-conf-文件中添加以下内容"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在-storage-conf-文件中添加以下内容"}},[s._v("#")]),s._v(" 在 "),a("code",[s._v("storage.conf")]),s._v(" 文件中添加以下内容：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecStart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecStart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/bin/dockerd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-g")]),s._v(" /data/docker "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-H")]),s._v(" fd://\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("这里，"),a("code",[s._v("-g /data/docker")]),s._v(" 参数指定了 Docker 的数据目录。")]),s._v(" "),a("p",[s._v("保存并关闭这个文件。")]),s._v(" "),a("h3",{attrs:{id:"重载-systemd-并重启-docker-服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重载-systemd-并重启-docker-服务"}},[s._v("#")]),s._v(" "),a("strong",[s._v("重载 systemd 并重启 Docker 服务")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl daemon-reload\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl start "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("现在，Docker 应该会将其数据存储在 "),a("code",[s._v("/data/docker")]),s._v(" 目录。你可以运行一个 Docker 容器，然后检查 "),a("code",[s._v("/data/docker")]),s._v(" 目录，看看是否有新的数据生成。")])])}),[],!1,null,null,null);a.default=r.exports}}]);